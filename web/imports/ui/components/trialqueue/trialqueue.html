<template name="trialqueue">
  <h2>Trial Queue</h2>

  <table class="table table-hover">
    <thead>
      <th>Id</th>
      <th>Docker Image</th>
      <th>Progress</th>
    </thead>
    <tbody>
    {{#each trialqueue}}
      <tr>
        <td><a href="{{pathFor route='Trial' trialId=_id}}">{{_id}}</a></td>
        <td>{{data.docker.image}}</td>
        <td>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar" role="progressbar" style="width: {{trialProgress _id}}%;" aria-valuenow="{{trialProgress _id}}" aria-valuemin="0" aria-valuemax="100">{{trialProgress _id}}%</div>
          </div>
        </td>
      </tr>
    {{/each}}
    </tbody>
  </table>

 {{#autoForm schema=TrialInsertSchema id="insertTrial" type="method" meteormethod="trialqueue.insert" validation="submitThenKeyup"}}
   <fieldset>
     <legend>Add Trial</legend>
   </fieldset>
   {{> afQuickField name="docker_image"}}
   {{> afQuickField name="docker_runtime"}}
   {{> afQuickField name="data_path"}}
   {{> afQuickField name="results_path"}}
   {{> afQuickField name="param_space" rows=10}}
   <button type="submit" class="btn btn-primary">Add Trial</button>
  {{/autoForm}}

  <a class="" data-toggle="collapse" href="#collapseTrialHistory" role="button" aria-expanded="false" aria-controls="collapseTrialHistory">
    <h2>Finished Trials</h2>
  </a>
  <div class="collapse" id="collapseTrialHistory">
    <table class="table table-hover">
      <thead>
        <th>Id</th>
        <th>Docker Image</th>
        <th>End Time</th>
      </thead>
      <tbody>
      {{#each trialhistory}}
        <tr>
          <td><a href="{{pathFor route='Trial' trialId=_id}}">{{_id}}</a></td>
          <td>{{data.docker.image}}</td>
          <td>{{niceTime end_time}}</td>
        </tr>
      {{/each}}
      </tbody>
    </table>
  </div>

</template>
